#!/usr/bin/env bash

# This script downloads large files and places them on the server
# if they are newer than binaries on the system
LARGE_FILE_FOLDER='large-files'
FILE_URLS=("https://s3-us-west-2.amazonaws.com/textiodemoclassifier/classifier.tar.gz")

echo "Starting large-files"
echo "BUILD_PATH is $BUILD_DIR"
bpwatch start large-files_install
# Save the current working directory and restore it at the end
pushd .

INSTALL_DIR=$BUILD_DIR/$LARGE_FILE_FOLDER
mkdir -p $INSTALL_DIR
cd $INSTALL_DIR

FILES_LEN=${#FILE_URLS[@]}
echo "Downloading $FILES_LEN files"
for (( i=0; i < FILES_LEN; i++))
do
    # Set variables    
    FILE_URL=${FILE_URLS[i]}

    echo "Downloading $FILE_URL"
    curl $FILE_URL | tar xz
    echo "directory contents are"
    pwd
    ls
done
popd
bpwatch stop large-files_install
echo "Ending large-files"

